.proposal_container( ui-if='proposal.has_support' )

  .main-proposal
    %div(id='big-percent') {{ proposal.votes_percentage }}
  .proposal_statement
    %h3 {{ proposal.statement }}
    .improve_support_buttons
      %ng-include( src="'/assets/shared/_social_buttons.html.haml'" )
      .btn-group( ng-show='currentUser && proposal.is_editable && proposal.user_id == currentUser.id' )

        %button( ng-click='improve(proposal.id)' popover='You may edit your proposal up until it receives its first support from another user.' popover-trigger="mouseenter" ) .

        %button( ng-click='improve(proposal.id)' class='btn btn-primary btn-bold edit' popover='You may edit your proposal up until it receives its first support from another user.' popover-trigger="mouseenter" ) <i class="icon-pencil"></i>

        %ng-href( class='btn btn-danger delete' rel='popover' data-title='Delete your proposal.' popover='You may delete your proposal up until it receives its first support from another user, or if support ever falls to zero.' popover-trigger="mouseenter" ) <i class="icon-trash"></i>
      .vote_buttons_container( ng-hide='currentUser && proposal.is_editable && proposal.user_id == currentUser.id' )
        %button( ng-click='support(proposal.id)' class='btn btn-primary btn-bold' style='margin-right: 10px' rel='popover' popover='Vote for this proposal' popover-trigger="mouseenter" ) Support
        %button( ng-click='improve(proposal.id)' class='btn btn-inverse btn-bold' rel='popover' title='Improve' popover='Create a better version of this proposal'  popover-trigger="mouseenter" data-html='true' ) Improve

  .supporting_arguments
    %h3(ng-show='proposal.has_support')
      Supporters
      %span ({{proposal.votes_count}} votes)
    .row
      .supporting_arguments_list.span11( ng-repeat="(key, vote) in proposal.votes" )
        .row.support_row{class: 'first'}
          .proposal-person.span3
            .user-avatar
              %img( ui-if='vote.facebook_auth' ng-src="http://graph.facebook.com/{{ vote.facebook_auth }}/picture?width=30&height=30" )
              %img( ui-if='!vote.facebook_auth' ng-src="http://gravatar.com/avatar/{{ vote.gravatar_hash }}.png?s=30&d={{ sessionSettings.spokenvote_attributes.defaultGravatar }}" )
            .supported_date
              %a(ng-href="user_id:{{ vote.user_id }}")  {{ vote.username }}
              %br
              {{ vote.created_at | date:'mediumDate' }}
          .support_comment.span8
            {{ vote.comment }}
