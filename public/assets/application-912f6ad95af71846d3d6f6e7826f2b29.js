+function($){"use strict";function transitionEnd(){var el=document.createElement("bootstrap"),transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var name in transEndEventNames)if(void 0!==el.style[name])return{end:transEndEventNames[name]};return!1}$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this;$(this).one($.support.transition.end,function(){called=!0});var callback=function(){called||$($el).trigger($.support.transition.end)};return setTimeout(callback,duration),this},$(function(){$.support.transition=transitionEnd()})}(jQuery),+function($){"use strict";var Collapse=function(element,options){this.$element=$(element),this.options=$.extend({},Collapse.DEFAULTS,options),this.transitioning=null,this.options.parent&&(this.$parent=$(this.options.parent)),this.options.toggle&&this.toggle()};Collapse.DEFAULTS={toggle:!0},Collapse.prototype.dimension=function(){var hasWidth=this.$element.hasClass("width");return hasWidth?"width":"height"},Collapse.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var startEvent=$.Event("show.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var actives=this.$parent&&this.$parent.find("> .panel > .in");if(actives&&actives.length){var hasData=actives.data("bs.collapse");if(hasData&&hasData.transitioning)return;actives.collapse("hide"),hasData||actives.data("bs.collapse",null)}var dimension=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[dimension](0),this.transitioning=1;var complete=function(){this.$element.removeClass("collapsing").addClass("collapse in")[dimension]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return complete.call(this);var scrollSize=$.camelCase(["scroll",dimension].join("-"));this.$element.one($.support.transition.end,$.proxy(complete,this)).emulateTransitionEnd(350)[dimension](this.$element[0][scrollSize])}}},Collapse.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var startEvent=$.Event("hide.bs.collapse");if(this.$element.trigger(startEvent),!startEvent.isDefaultPrevented()){var dimension=this.dimension();this.$element[dimension](this.$element[dimension]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var complete=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return $.support.transition?(this.$element[dimension](0).one($.support.transition.end,$.proxy(complete,this)).emulateTransitionEnd(350),void 0):complete.call(this)}}},Collapse.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var old=$.fn.collapse;$.fn.collapse=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.collapse"),options=$.extend({},Collapse.DEFAULTS,$this.data(),"object"==typeof option&&option);!data&&options.toggle&&"show"==option&&(option=!option),data||$this.data("bs.collapse",data=new Collapse(this,options)),"string"==typeof option&&data[option]()})},$.fn.collapse.Constructor=Collapse,$.fn.collapse.noConflict=function(){return $.fn.collapse=old,this},$(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(e){var href,$this=$(this),target=$this.attr("data-target")||e.preventDefault()||(href=$this.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,""),$target=$(target),data=$target.data("bs.collapse"),option=data?"toggle":$this.data(),parent=$this.attr("data-parent"),$parent=parent&&$(parent);data&&data.transitioning||($parent&&$parent.find('[data-toggle=collapse][data-parent="'+parent+'"]').not($this).addClass("collapsed"),$this[$target.hasClass("in")?"addClass":"removeClass"]("collapsed")),$target.collapse(option)})}(jQuery);var Holder=Holder||{};!function(app,win){function contentLoaded(n,t){var l="complete",s="readystatechange",u=!1,h=u,c=!0,i=n.document,a=i.documentElement,e=i.addEventListener?"addEventListener":"attachEvent",v=i.addEventListener?"removeEventListener":"detachEvent",f=i.addEventListener?"":"on",r=function(e){(e.type!=s||i.readyState==l)&&(("load"==e.type?n:i)[v](f+e.type,r,u),!h&&(h=!0)&&t.call(n,null))},o=function(){try{a.doScroll("left")}catch(n){return setTimeout(o,50),void 0}r("poll")};if(i.readyState==l)t.call(n,"lazy");else{if(i.createEventObject&&a.doScroll){try{c=!n.frameElement}catch(y){}c&&o()}i[e](f+"DOMContentLoaded",r,u),i[e](f+s,r,u),n[e](f+"load",r,u)}}function selector(a){a=a.match(/^(\W)?(.*)/);var b=document["getElement"+(a[1]?"#"==a[1]?"ById":"sByClassName":"sByTagName")](a[2]),ret=[];return null!=b&&(ret=b.length?b:0==b.length?b:[b]),ret}function extend(a,b){var c={};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c}function text_size(width,height,template){var dimension_arr=[height,width].sort(),maxFactor=Math.round(dimension_arr[1]/16),text_height=(Math.round(dimension_arr[0]/16),Math.max(template.size,maxFactor));return{height:text_height}}function draw(ctx,dimensions,template,ratio){var ts=text_size(dimensions.width,dimensions.height,template),text_height=ts.height,width=dimensions.width*ratio,height=dimensions.height*ratio,font=template.font?template.font:"sans-serif";canvas.width=width,canvas.height=height,ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillStyle=template.background,ctx.fillRect(0,0,width,height),ctx.fillStyle=template.foreground,ctx.font="bold "+text_height+"px "+font;var text=template.text?template.text:dimensions.width+"x"+dimensions.height;return ctx.measureText(text).width/width>1&&(text_height=template.size/(ctx.measureText(text).width/width)),ctx.font="bold "+text_height*ratio+"px "+font,ctx.fillText(text,width/2,height/2,width),canvas.toDataURL("image/png")}function render(mode,el,holder,src){var dimensions=holder.dimensions,theme=holder.theme,text=holder.text?decodeURIComponent(holder.text):holder.text,dimensions_caption=dimensions.width+"x"+dimensions.height;theme=text?extend(theme,{text:text}):theme,theme=holder.font?extend(theme,{font:holder.font}):theme;var ratio=1;window.devicePixelRatio&&window.devicePixelRatio>1&&(ratio=window.devicePixelRatio),"image"==mode?(el.setAttribute("data-src",src),el.setAttribute("alt",text?text:theme.text?theme.text+" ["+dimensions_caption+"]":dimensions_caption),(fallback||!holder.auto)&&(el.style.width=dimensions.width+"px",el.style.height=dimensions.height+"px"),fallback?el.style.backgroundColor=theme.background:el.setAttribute("src",draw(ctx,dimensions,theme,ratio))):fallback||(el.style.backgroundImage="url("+draw(ctx,dimensions,theme,ratio)+")",el.style.backgroundSize=dimensions.width+"px "+dimensions.height+"px")}function fluid(el,holder){var dimensions=holder.dimensions,theme=holder.theme,text=holder.text,dimensions_caption=dimensions.width+"x"+dimensions.height;theme=text?extend(theme,{text:text}):theme;var fluid=document.createElement("div");fluid.style.backgroundColor=theme.background,fluid.style.color=theme.foreground,fluid.className=el.className+" holderjs-fluid",fluid.style.width=holder.dimensions.width+(holder.dimensions.width.indexOf("%")>0?"":"px"),fluid.style.height=holder.dimensions.height+(holder.dimensions.height.indexOf("%")>0?"":"px"),fluid.id=el.id,el.style.width=0,el.style.height=0,theme.text?fluid.appendChild(document.createTextNode(theme.text)):(fluid.appendChild(document.createTextNode(dimensions_caption)),fluid_images.push(fluid),setTimeout(fluid_update,0)),el.parentNode.insertBefore(fluid,el.nextSibling),window.jQuery&&jQuery(function($){$(el).on("load",function(){el.style.width=fluid.style.width,el.style.height=fluid.style.height,$(el).show(),$(fluid).remove()})})}function fluid_update(){for(i in fluid_images)if(fluid_images.hasOwnProperty(i)){var el=fluid_images[i],label=el.firstChild;el.style.lineHeight=el.offsetHeight+"px",label.data=el.offsetWidth+"x"+el.offsetHeight}}function parse_flags(flags,options){var ret={theme:settings.themes.gray},render=!1;for(sl=flags.length,j=0;sl>j;j++){var flag=flags[j];app.flags.dimensions.match(flag)?(render=!0,ret.dimensions=app.flags.dimensions.output(flag)):app.flags.fluid.match(flag)?(render=!0,ret.dimensions=app.flags.fluid.output(flag),ret.fluid=!0):app.flags.colors.match(flag)?ret.theme=app.flags.colors.output(flag):options.themes[flag]?ret.theme=options.themes[flag]:app.flags.text.match(flag)?ret.text=app.flags.text.output(flag):app.flags.font.match(flag)?ret.font=app.flags.font.output(flag):app.flags.auto.match(flag)&&(ret.auto=!0)}return render?ret:!1}var preempted=!1,fallback=!1,canvas=document.createElement("canvas");if(document.getElementsByClassName||(document.getElementsByClassName=function(e){var n,r,i,t=document,s=[];if(t.querySelectorAll)return t.querySelectorAll("."+e);if(t.evaluate)for(r=".//*[contains(concat(' ', @class, ' '), ' "+e+" ')]",n=t.evaluate(r,t,null,0,null);i=n.iterateNext();)s.push(i);else for(n=t.getElementsByTagName("*"),r=new RegExp("(^|\\s)"+e+"(\\s|$)"),i=0;i<n.length;i++)r.test(n[i].className)&&s.push(n[i]);return s}),window.getComputedStyle||(window.getComputedStyle=function(e){return this.el=e,this.getPropertyValue=function(t){var n=/(\-([a-z]){1})/g;return"float"==t&&(t="styleFloat"),n.test(t)&&(t=t.replace(n,function(){return arguments[2].toUpperCase()})),e.currentStyle[t]?e.currentStyle[t]:null},this}),Object.prototype.hasOwnProperty||(Object.prototype.hasOwnProperty=function(prop){var proto=this.__proto__||this.constructor.prototype;return prop in this&&(!(prop in proto)||proto[prop]!==this[prop])}),canvas.getContext)if(canvas.toDataURL("image/png").indexOf("data:image/png")<0)fallback=!0;else var ctx=canvas.getContext("2d");else fallback=!0;var fluid_images=[],settings={domain:"holder.js",images:"img",bgnodes:".holderjs",themes:{gray:{background:"#eee",foreground:"#aaa",size:12},social:{background:"#3a5a97",foreground:"#fff",size:12},industrial:{background:"#434A52",foreground:"#C2F200",size:12}},stylesheet:".holderjs-fluid {font-size:16px;font-weight:bold;text-align:center;font-family:sans-serif;margin:0}"};app.flags={dimensions:{regex:/^(\d+)x(\d+)$/,output:function(val){var exec=this.regex.exec(val);return{width:+exec[1],height:+exec[2]}}},fluid:{regex:/^([0-9%]+)x([0-9%]+)$/,output:function(val){var exec=this.regex.exec(val);return{width:exec[1],height:exec[2]}}},colors:{regex:/#([0-9a-f]{3,})\:#([0-9a-f]{3,})/i,output:function(val){var exec=this.regex.exec(val);return{size:settings.themes.gray.size,foreground:"#"+exec[2],background:"#"+exec[1]}}},text:{regex:/text\:(.*)/,output:function(val){return this.regex.exec(val)[1]}},font:{regex:/font\:(.*)/,output:function(val){return this.regex.exec(val)[1]}},auto:{regex:/^auto$/}};for(var flag in app.flags)app.flags.hasOwnProperty(flag)&&(app.flags[flag].match=function(val){return val.match(this.regex)});app.add_theme=function(name,theme){return null!=name&&null!=theme&&(settings.themes[name]=theme),app},app.add_image=function(src,el){var node=selector(el);if(node.length)for(var i=0,l=node.length;l>i;i++){var img=document.createElement("img");img.setAttribute("data-src",src),node[i].appendChild(img)}return app},app.run=function(o){var options=extend(settings,o),images=[];for(imageNodes=options.images instanceof window.NodeList?options.images:options.images instanceof window.Node?[options.images]:selector(options.images),bgnodes=options.elements instanceof window.NodeList?options.bgnodes:options.bgnodes instanceof window.Node?[options.bgnodes]:selector(options.bgnodes),preempted=!0,i=0,l=imageNodes.length;l>i;i++)images.push(imageNodes[i]);var holdercss=document.getElementById("holderjs-style");holdercss||(holdercss=document.createElement("style"),holdercss.setAttribute("id","holderjs-style"),holdercss.type="text/css",document.getElementsByTagName("head")[0].appendChild(holdercss)),holdercss.styleSheet?holdercss.styleSheet+=options.stylesheet:holdercss.textContent+=options.stylesheet;for(var cssregex=new RegExp(options.domain+'/(.*?)"?\\)'),l=bgnodes.length,i=0;l>i;i++){var src=window.getComputedStyle(bgnodes[i],null).getPropertyValue("background-image"),flags=src.match(cssregex);if(flags){var holder=parse_flags(flags[1].split("/"),options);holder&&render("background",bgnodes[i],holder,src)}}for(var l=images.length,i=0;l>i;i++){var src=images[i].getAttribute("src")||images[i].getAttribute("data-src");if(null!=src&&src.indexOf(options.domain)>=0){var holder=parse_flags(src.substr(src.lastIndexOf(options.domain)+options.domain.length+1).split("/"),options);holder&&(holder.fluid?fluid(images[i],holder,src):render("image",images[i],holder,src))}}return app},contentLoaded(win,function(){window.addEventListener?(window.addEventListener("resize",fluid_update,!1),window.addEventListener("orientationchange",fluid_update,!1)):window.attachEvent("onresize",fluid_update),preempted||app.run()}),"function"==typeof define&&define.amd&&define("Holder",[],function(){return app})}(Holder,window),function(e){"use strict";function t(){this.collection={},this.maxListeners=10}var n=e.Object,r=e.Array,i=function(){return"function"==typeof r.isArray?r.isArray:function(e){return"[object Array]"===n.prototype.toString.call(e)}}();t.prototype.addListener=function(e,t,n){if(void 0===e)throw new Error('jvent - "addListener(event, listener)": It should receive an event.');if(void 0===t)throw new Error('jvent - "addListener(event, listener)": It should receive a listener function.');var r=this.collection;if(t.once=n||!1,void 0===r[e]&&(r[e]=[]),r[e].length+1>this.maxListeners&&0!==this.maxListeners)throw new Error("Warning: So many listeners for an event.");return r[e].push(t),this.emit("newListener"),this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(e,t){return this.on(e,t,!0),this},t.prototype.removeListener=function(e,t){if(void 0===e)throw new Error('jvent - "removeListener(event, listener)": It should receive an event.');if(void 0===t)throw new Error('jvent - "removeListener(event, listener)": It should receive a listener function.');var s,n=this.collection[e],r=0;if(i(n))for(s=n.length,r;s>r;r+=1)if(n[r]===t){n.splice(r,1);break}return this},t.prototype.off=t.prototype.removeListener,t.prototype.removeAllListeners=function(e){if(void 0===e)throw new Error('jvent - "removeAllListeners(event)": It should receive an event.');return delete this.collection[e],this},t.prototype.setMaxListeners=function(e){if(isNaN(e))throw new Error('jvent - "setMaxListeners(n)": It should receive a number.');return this.maxListeners=e,this},t.prototype.listeners=function(e){if(void 0===e)throw new Error('jvent - "listeners(event)": It should receive an event.');if(void 0===this.collection[e])throw new Error('jvent - "listeners(event)": The event must exist into the collection.');return this.collection[e]},t.prototype.emit=function(){var n,r,s,e=arguments,t=e[0];if(void 0===t)throw new Error('jvent - "emit(event)": It should receive an event.');if("string"==typeof t&&(t={type:t}),t.target||(t.target=this),i(this.collection[t.type]))for(n=this.collection[t.type],r=0,s=n.length,r;s>r;r+=1)n[r].apply(this,arguments),n[r].once&&(this.off(t.type,n[r]),s-=1,r-=1);return this},"function"==typeof e.define&&void 0!==e.define.amd?e.define("Jvent",[],function(){return t}):"undefined"!=typeof module&&void 0!==module.exports?module.exports=t:e.Jvent=e.EventEmitter=t}(this),function(e){"use strict";function f(){if(u||a){var e=u?"resize":"scroll";this.refresh(),u=!1,a=!1,this.emit(e)}}function l(){this.init()}var t=e,n=t.document,r=n.documentElement,i=t.addEventListener||t.attachEvent,s=t.attachEvent?"onresize":"resize",o=t.attachEvent?"onscroll":"scroll",u=!1,a=!1;i(s,function(){u=!0}),i(o,function(){a=!0}),l.prototype=new Jvent,l.prototype.init=function(){var e=this;e.refresh(),e.calculateDeviceDimensions(),t.setInterval(function(){f.call(e)},350)},l.prototype.device={},l.prototype.cordinate={},l.prototype.calculateDimensions=function(){this.height=r.clientHeight,this.width=r.clientWidth},l.prototype.calculateDeviceDimensions=function(){this.device.height=t.screen.height,this.device.width=t.screen.width},l.prototype.calculateScroll=function(){this.scrollY=t.pageYOffset||r.scrollTop,this.scrollX=t.pageXOffset||r.scrollLeft,0===this.scrollY?this.emit("top"):this.height+this.scrollY>=n.body.scrollHeight&&this.emit("bottom")},l.prototype.calculateOffset=function(){this.top=this.scrollY,this.right=this.scrollX+this.width,this.bottom=this.scrollY+this.height,this.left=this.scrollX},l.prototype.calculateMousePostition=function(t){var i=0,s=0;return t=t||e.event,t.pageX||t.pageY?(i=t.pageX,s=t.pageY):(i=t.clientX+n.body.scrollLeft+r.scrollLeft,s=t.clientY+n.body.scrollTop+r.scrollTop),{posX:i,posY:s}},l.prototype.calculateOrientation=function(){this.orientation=90===Math.abs(t.orientation)?"landscape":"portrait"},l.prototype.inViewport=function(e){var t=e.getBoundingClientRect();return t.top>0&&t.right<this.width&&t.bottom<this.height&&t.left>0},l.prototype.isVisible=function(e){var t=e.getBoundingClientRect();return t.height>=this.top},l.prototype.refresh=function(){this.calculateDimensions(),this.calculateScroll(),this.calculateOffset(),this.calculateOrientation()},"function"==typeof e.define&&void 0!==e.define.amd?e.define("Viewport",[],function(){return l}):"undefined"!=typeof module&&void 0!==module.exports?module.exports=l:e.Viewport=l}(this),angular.module("ui.config",[]).value("ui.config",{}),angular.module("ui.filters",["ui.config"]),angular.module("ui.directives",["ui.config"]),angular.module("ui",["ui.filters","ui.directives","ui.config"]),angular.module("ui.directives").directive("uiAnimate",["ui.config","$timeout",function(uiConfig,$timeout){var options={};return angular.isString(uiConfig.animate)?options["class"]=uiConfig.animate:uiConfig.animate&&(options=uiConfig.animate),{restrict:"A",link:function($scope,element,attrs){var opts={};attrs.uiAnimate&&(opts=$scope.$eval(attrs.uiAnimate),angular.isString(opts)&&(opts={"class":opts})),opts=angular.extend({"class":"ui-animate"},options,opts),element.addClass(opts["class"]),$timeout(function(){element.removeClass(opts["class"])},20,!1)}}}]),angular.module("ui.directives").directive("uiCalendar",["ui.config","$parse",function(uiConfig){return uiConfig.uiCalendar=uiConfig.uiCalendar||{},{require:"ngModel",restrict:"A",link:function(scope,elm,attrs){function update(){scope.calendar=elm.html("");var view=scope.calendar.fullCalendar("getView");view&&(view=view.name);var expression,options={defaultView:view,eventSources:sources};expression=attrs.uiCalendar?scope.$eval(attrs.uiCalendar):{},angular.extend(options,uiConfig.uiCalendar,expression),scope.calendar.fullCalendar(options)}var sources=scope.$eval(attrs.ngModel),tracker=0,getSources=function(){var equalsTracker=scope.$eval(attrs.equalsTracker);return tracker=0,angular.forEach(sources,function(value){angular.isArray(value)&&(tracker+=value.length)}),angular.isNumber(equalsTracker)?tracker+sources.length+equalsTracker:tracker+sources.length};update(),scope.$watch(getSources,function(){update()})}}}]),angular.module("ui.directives").directive("uiCodemirror",["ui.config","$timeout",function(uiConfig,$timeout){"use strict";var events=["cursorActivity","viewportChange","gutterClick","focus","blur","scroll","update"];return{restrict:"A",require:"ngModel",link:function(scope,elm,attrs,ngModel){var options,opts,onChange,deferCodeMirror,codeMirror;if("textarea"!==elm[0].type)throw new Error("uiCodemirror3 can only be applied to a textarea element");options=uiConfig.codemirror||{},opts=angular.extend({},options,scope.$eval(attrs.uiCodemirror)),onChange=function(aEvent){return function(instance,changeObj){var newValue=instance.getValue();newValue!==ngModel.$viewValue&&(ngModel.$setViewValue(newValue),scope.$apply()),"function"==typeof aEvent&&aEvent(instance,changeObj)}},deferCodeMirror=function(){codeMirror=CodeMirror.fromTextArea(elm[0],opts),codeMirror.on("change",onChange(opts.onChange));for(var aEvent,i=0,n=events.length;n>i;++i)aEvent=opts["on"+events[i].charAt(0).toUpperCase()+events[i].slice(1)],void 0!==aEvent&&"function"==typeof aEvent&&codeMirror.on(events[i],aEvent);ngModel.$formatters.push(function(value){if(angular.isUndefined(value)||null===value)return"";if(angular.isObject(value)||angular.isArray(value))throw new Error("ui-codemirror cannot use an object or an array as a model");return value}),ngModel.$render=function(){codeMirror.setValue(ngModel.$viewValue)},attrs.uiRefresh&&scope.$watch(attrs.uiRefresh,function(newVal,oldVal){newVal!==oldVal&&$timeout(codeMirror.refresh)})},$timeout(deferCodeMirror)}}}]),angular.module("ui.directives").directive("uiCurrency",["ui.config","currencyFilter",function(uiConfig,currencyFilter){var options={pos:"ui-currency-pos",neg:"ui-currency-neg",zero:"ui-currency-zero"};return uiConfig.currency&&angular.extend(options,uiConfig.currency),{restrict:"EAC",require:"ngModel",link:function(scope,element,attrs,controller){var opts,renderview,value;opts=angular.extend({},options,scope.$eval(attrs.uiCurrency)),renderview=function(viewvalue){var num;return num=1*viewvalue,element.toggleClass(opts.pos,num>0),element.toggleClass(opts.neg,0>num),element.toggleClass(opts.zero,0===num),""===viewvalue?element.text(""):element.text(currencyFilter(num,opts.symbol)),!0},controller.$render=function(){value=controller.$viewValue,element.val(value),renderview(value)}}}}]),angular.module("ui.directives").directive("uiDate",["ui.config",function(uiConfig){"use strict";var options;return options={},angular.isObject(uiConfig.date)&&angular.extend(options,uiConfig.date),{require:"?ngModel",link:function(scope,element,attrs,controller){var getOptions=function(){return angular.extend({},uiConfig.date,scope.$eval(attrs.uiDate))},initDateWidget=function(){var opts=getOptions();if(controller){var updateModel=function(){scope.$apply(function(){var date=element.datepicker("getDate");element.datepicker("setDate",element.val()),controller.$setViewValue(date),element.blur()})};if(opts.onSelect){var userHandler=opts.onSelect;opts.onSelect=function(value,picker){updateModel(),scope.$apply(function(){userHandler(value,picker)})}}else opts.onSelect=updateModel;element.bind("change",updateModel),controller.$render=function(){var date=controller.$viewValue;if(angular.isDefined(date)&&null!==date&&!angular.isDate(date))throw new Error("ng-Model value must be a Date object - currently it is a "+typeof date+" - use ui-date-format to convert it from a string");element.datepicker("setDate",date)}}element.datepicker("destroy"),element.datepicker(opts),controller&&controller.$render()};scope.$watch(getOptions,initDateWidget,!0)}}}]).directive("uiDateFormat",["ui.config",function(uiConfig){var directive={require:"ngModel",link:function(scope,element,attrs,modelCtrl){var dateFormat=attrs.uiDateFormat||uiConfig.dateFormat;dateFormat?(modelCtrl.$formatters.push(function(value){return angular.isString(value)?$.datepicker.parseDate(dateFormat,value):void 0}),modelCtrl.$parsers.push(function(value){return value?$.datepicker.formatDate(dateFormat,value):void 0})):(modelCtrl.$formatters.push(function(value){return angular.isString(value)?new Date(value):void 0}),modelCtrl.$parsers.push(function(value){return value?value.toISOString():void 0}))}};return directive}]),angular.module("ui.directives").directive("uiEvent",["$parse",function($parse){return function(scope,elm,attrs){var events=scope.$eval(attrs.uiEvent);angular.forEach(events,function(uiEvent,eventName){var fn=$parse(uiEvent);elm.bind(eventName,function(evt){var params=Array.prototype.slice.call(arguments);params=params.splice(1),scope.$apply(function(){fn(scope,{$event:evt,$params:params})})})})}}]),angular.module("ui.directives").directive("uiIf",[function(){return{transclude:"element",priority:1e3,terminal:!0,restrict:"A",compile:function(element,attr,transclude){return function(scope,element,attr){var childElement,childScope;scope.$watch(attr.uiIf,function(newValue){childElement&&(childElement.remove(),childElement=void 0),childScope&&(childScope.$destroy(),childScope=void 0),newValue&&(childScope=scope.$new(),transclude(childScope,function(clone){childElement=clone,element.after(clone)}))})}}}}]),angular.module("ui.directives").directive("uiJq",["ui.config","$timeout",function(uiConfig,$timeout){return{restrict:"A",compile:function(tElm,tAttrs){if(!angular.isFunction(tElm[tAttrs.uiJq]))throw new Error('ui-jq: The "'+tAttrs.uiJq+'" function does not exist');var options=uiConfig.jq&&uiConfig.jq[tAttrs.uiJq];return function(scope,elm,attrs){function callPlugin(){$timeout(function(){elm[attrs.uiJq].apply(elm,linkOptions)},0,!1)}var linkOptions=[];attrs.uiOptions?(linkOptions=scope.$eval("["+attrs.uiOptions+"]"),angular.isObject(options)&&angular.isObject(linkOptions[0])&&(linkOptions[0]=angular.extend({},options,linkOptions[0]))):options&&(linkOptions=[options]),attrs.ngModel&&elm.is("select,input,textarea")&&elm.on("change",function(){elm.trigger("input")}),attrs.uiRefresh&&scope.$watch(attrs.uiRefresh,function(){callPlugin()}),callPlugin()}}}}]),angular.module("ui.directives").factory("keypressHelper",["$parse",function($parse){var keysByCode={8:"backspace",9:"tab",13:"enter",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete"},capitaliseFirstLetter=function(string){return string.charAt(0).toUpperCase()+string.slice(1)};return function(mode,scope,elm,attrs){var params,combinations=[];params=scope.$eval(attrs["ui"+capitaliseFirstLetter(mode)]),angular.forEach(params,function(v,k){var combination,expression;expression=$parse(v),angular.forEach(k.split(" "),function(variation){combination={expression:expression,keys:{}},angular.forEach(variation.split("-"),function(value){combination.keys[value]=!0}),combinations.push(combination)})}),elm.bind(mode,function(event){var altPressed=event.metaKey||event.altKey,ctrlPressed=event.ctrlKey,shiftPressed=event.shiftKey,keyCode=event.keyCode;"keypress"===mode&&!shiftPressed&&keyCode>=97&&122>=keyCode&&(keyCode-=32),angular.forEach(combinations,function(combination){var mainKeyPressed=combination.keys[keysByCode[event.keyCode]]||combination.keys[event.keyCode.toString()]||!1,altRequired=combination.keys.alt||!1,ctrlRequired=combination.keys.ctrl||!1,shiftRequired=combination.keys.shift||!1;mainKeyPressed&&altRequired==altPressed&&ctrlRequired==ctrlPressed&&shiftRequired==shiftPressed&&scope.$apply(function(){combination.expression(scope,{$event:event})})})})}}]),angular.module("ui.directives").directive("uiKeydown",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keydown",scope,elm,attrs)}}}]),angular.module("ui.directives").directive("uiKeypress",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keypress",scope,elm,attrs)}}}]),angular.module("ui.directives").directive("uiKeyup",["keypressHelper",function(keypressHelper){return{link:function(scope,elm,attrs){keypressHelper("keyup",scope,elm,attrs)}}}]),function(){function bindMapEvents(scope,eventsStr,googleObject,element){angular.forEach(eventsStr.split(" "),function(eventName){var $event={type:"map-"+eventName};google.maps.event.addListener(googleObject,eventName,function(evt){element.triggerHandler(angular.extend({},$event,evt)),scope.$$phase||scope.$apply()})})}function mapOverlayDirective(directiveName,events){app.directive(directiveName,[function(){return{restrict:"A",link:function(scope,elm,attrs){scope.$watch(attrs[directiveName],function(newObject){bindMapEvents(scope,events,newObject,elm)})}}}])}var app=angular.module("ui.directives");app.directive("uiMap",["ui.config","$parse",function(uiConfig,$parse){var mapEvents="bounds_changed center_changed click dblclick drag dragend dragstart heading_changed idle maptypeid_changed mousemove mouseout mouseover projection_changed resize rightclick tilesloaded tilt_changed zoom_changed",options=uiConfig.map||{};return{restrict:"A",link:function(scope,elm,attrs){var opts=angular.extend({},options,scope.$eval(attrs.uiOptions)),map=new google.maps.Map(elm[0],opts),model=$parse(attrs.uiMap);model.assign(scope,map),bindMapEvents(scope,mapEvents,map,elm)}}}]),app.directive("uiMapInfoWindow",["ui.config","$parse","$compile",function(uiConfig,$parse,$compile){var infoWindowEvents="closeclick content_change domready position_changed zindex_changed",options=uiConfig.mapInfoWindow||{};return{link:function(scope,elm,attrs){var opts=angular.extend({},options,scope.$eval(attrs.uiOptions));opts.content=elm[0];var model=$parse(attrs.uiMapInfoWindow),infoWindow=model(scope);infoWindow||(infoWindow=new google.maps.InfoWindow(opts),model.assign(scope,infoWindow)),bindMapEvents(scope,infoWindowEvents,infoWindow,elm),elm.replaceWith("<div></div>");var _open=infoWindow.open;infoWindow.open=function(a1,a2,a3,a4,a5,a6){$compile(elm.contents())(scope),_open.call(infoWindow,a1,a2,a3,a4,a5,a6)}}}}]),mapOverlayDirective("uiMapMarker","animation_changed click clickable_changed cursor_changed dblclick drag dragend draggable_changed dragstart flat_changed icon_changed mousedown mouseout mouseover mouseup position_changed rightclick shadow_changed shape_changed title_changed visible_changed zindex_changed"),mapOverlayDirective("uiMapPolyline","click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapPolygon","click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapRectangle","bounds_changed click dblclick mousedown mousemove mouseout mouseover mouseup rightclick"),mapOverlayDirective("uiMapCircle","center_changed click dblclick mousedown mousemove mouseout mouseover mouseup radius_changed rightclick"),mapOverlayDirective("uiMapGroundOverlay","click dblclick")}(),angular.module("ui.directives").directive("uiMask",[function(){return{require:"ngModel",link:function($scope,element,attrs,controller){controller.$render=function(){var value=controller.$viewValue||"";element.val(value),element.mask($scope.$eval(attrs.uiMask))},controller.$parsers.push(function(value){var isValid=element.isMaskValid()||angular.isUndefined(element.isMaskValid())&&element.val().length>0;return controller.$setValidity("mask",isValid),isValid?value:void 0}),element.bind("keyup",function(){$scope.$apply(function(){controller.$setViewValue(element.mask())})})}}}]),angular.module("ui.directives").directive("uiReset",["ui.config",function(uiConfig){var resetValue=null;return void 0!==uiConfig.reset&&(resetValue=uiConfig.reset),{require:"ngModel",link:function(scope,elm,attrs,ctrl){var aElement;aElement=angular.element('<a class="ui-reset" />'),elm.wrap('<span class="ui-resetwrap" />').after(aElement),aElement.bind("click",function(e){e.preventDefault(),scope.$apply(function(){attrs.uiReset?ctrl.$setViewValue(scope.$eval(attrs.uiReset)):ctrl.$setViewValue(resetValue),ctrl.$render()})})}}}]),angular.module("ui.directives").directive("uiRoute",["$location","$parse",function($location,$parse){return{restrict:"AC",compile:function(tElement,tAttrs){var useProperty;if(tAttrs.uiRoute)useProperty="uiRoute";else if(tAttrs.ngHref)useProperty="ngHref";else{if(!tAttrs.href)throw new Error("uiRoute missing a route or href property on "+tElement[0]);useProperty="href"}return function($scope,elm,attrs){function staticWatcher(newVal){(hash=newVal.indexOf("#"))>-1&&(newVal=newVal.substr(hash+1)),(watcher=function(){modelSetter($scope,$location.path().indexOf(newVal)>-1)})()}function regexWatcher(newVal){(hash=newVal.indexOf("#"))>-1&&(newVal=newVal.substr(hash+1)),(watcher=function(){var regexp=new RegExp("^"+newVal+"$",["i"]);modelSetter($scope,regexp.test($location.path()))})()}var modelSetter=$parse(attrs.ngModel||attrs.routeModel||"$uiRoute").assign,watcher=angular.noop;switch(useProperty){case"uiRoute":attrs.uiRoute?regexWatcher(attrs.uiRoute):attrs.$observe("uiRoute",regexWatcher);break;case"ngHref":attrs.ngHref?staticWatcher(attrs.ngHref):attrs.$observe("ngHref",staticWatcher);break;case"href":staticWatcher(attrs.href)}$scope.$on("$routeChangeSuccess",function(){watcher()})}}}}]),angular.module("ui.directives").directive("uiScrollfix",["$window",function($window){"use strict";return{link:function(scope,elm,attrs){var top=elm.offset().top;attrs.uiScrollfix?"-"===attrs.uiScrollfix.charAt(0)?attrs.uiScrollfix=top-attrs.uiScrollfix.substr(1):"+"===attrs.uiScrollfix.charAt(0)&&(attrs.uiScrollfix=top+parseFloat(attrs.uiScrollfix.substr(1))):attrs.uiScrollfix=top,angular.element($window).on("scroll.ui-scrollfix",function(){var offset;if(angular.isDefined($window.pageYOffset))offset=$window.pageYOffset;
else{var iebody=document.compatMode&&"BackCompat"!==document.compatMode?document.documentElement:document.body;offset=iebody.scrollTop}!elm.hasClass("ui-scrollfix")&&offset>attrs.uiScrollfix?elm.addClass("ui-scrollfix"):elm.hasClass("ui-scrollfix")&&offset<attrs.uiScrollfix&&elm.removeClass("ui-scrollfix")})}}}]),angular.module("ui.directives").directive("uiSelect2",["ui.config","$timeout",function(uiConfig,$timeout){var options={};return uiConfig.select2&&angular.extend(options,uiConfig.select2),{require:"?ngModel",compile:function(tElm,tAttrs){var watch,repeatOption,repeatAttr,isSelect=tElm.is("select"),isMultiple=void 0!==tAttrs.multiple;return tElm.is("select")&&(repeatOption=tElm.find("option[ng-repeat], option[data-ng-repeat]"),repeatOption.length&&(repeatAttr=repeatOption.attr("ng-repeat")||repeatOption.attr("data-ng-repeat"),watch=jQuery.trim(repeatAttr.split("|")[0]).split(" ").pop())),function(scope,elm,attrs,controller){var opts=angular.extend({},options,scope.$eval(attrs.uiSelect2));if(isSelect?(delete opts.multiple,delete opts.initSelection):isMultiple&&(opts.multiple=!0),controller&&(controller.$render=function(){isSelect?elm.select2("val",controller.$modelValue):isMultiple?controller.$modelValue?angular.isArray(controller.$modelValue)?elm.select2("data",controller.$modelValue):elm.select2("val",controller.$modelValue):elm.select2("data",[]):angular.isObject(controller.$modelValue)?elm.select2("data",controller.$modelValue):elm.select2("val",controller.$modelValue)},watch&&scope.$watch(watch,function(newVal){newVal&&$timeout(function(){elm.select2("val",controller.$viewValue),elm.trigger("change")})}),!isSelect&&(elm.bind("change",function(){scope.$apply(function(){controller.$setViewValue(elm.select2("data"))})}),opts.initSelection))){var initSelection=opts.initSelection;opts.initSelection=function(element,callback){initSelection(element,function(value){controller.$setViewValue(value),callback(value)})}}attrs.$observe("disabled",function(value){elm.select2(value&&"disable"||"enable")}),attrs.ngMultiple&&scope.$watch(attrs.ngMultiple,function(){elm.select2(opts)}),elm.val(scope.$eval(attrs.ngModel)),$timeout(function(){elm.select2(opts),opts.initSelection||isSelect||controller.$setViewValue(elm.select2("data"))})}}}}]),angular.module("ui.directives").directive("uiShow",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiShow,function(newVal){newVal?elm.addClass("ui-show"):elm.removeClass("ui-show")})}}]).directive("uiHide",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiHide,function(newVal){newVal?elm.addClass("ui-hide"):elm.removeClass("ui-hide")})}}]).directive("uiToggle",[function(){return function(scope,elm,attrs){scope.$watch(attrs.uiToggle,function(newVal){newVal?elm.removeClass("ui-hide").addClass("ui-show"):elm.removeClass("ui-show").addClass("ui-hide")})}}]),angular.module("ui.directives").directive("uiSortable",["ui.config",function(uiConfig){return{require:"?ngModel",link:function(scope,element,attrs,ngModel){var onReceive,onRemove,onStart,onUpdate,opts,_receive,_remove,_start,_update;opts=angular.extend({},uiConfig.sortable,scope.$eval(attrs.uiSortable)),ngModel&&(ngModel.$render=function(){element.sortable("refresh")},onStart=function(e,ui){ui.item.sortable={index:ui.item.index()}},onUpdate=function(e,ui){ui.item.sortable.resort=ngModel},onReceive=function(e,ui){ui.item.sortable.relocate=!0,ngModel.$modelValue.splice(ui.item.index(),0,ui.item.sortable.moved)},onRemove=function(e,ui){ui.item.sortable.moved=1===ngModel.$modelValue.length?ngModel.$modelValue.splice(0,1)[0]:ngModel.$modelValue.splice(ui.item.sortable.index,1)[0]},onStop=function(e,ui){if(ui.item.sortable.resort&&!ui.item.sortable.relocate){var end,start;start=ui.item.sortable.index,end=ui.item.index(),end>start&&end--,ui.item.sortable.resort.$modelValue.splice(end,0,ui.item.sortable.resort.$modelValue.splice(start,1)[0])}(ui.item.sortable.resort||ui.item.sortable.relocate)&&scope.$apply()},_start=opts.start,opts.start=function(e,ui){onStart(e,ui),"function"==typeof _start&&_start(e,ui)},_stop=opts.stop,opts.stop=function(e,ui){onStop(e,ui),"function"==typeof _stop&&_stop(e,ui)},_update=opts.update,opts.update=function(e,ui){onUpdate(e,ui),"function"==typeof _update&&_update(e,ui)},_receive=opts.receive,opts.receive=function(e,ui){onReceive(e,ui),"function"==typeof _receive&&_receive(e,ui)},_remove=opts.remove,opts.remove=function(e,ui){onRemove(e,ui),"function"==typeof _remove&&_remove(e,ui)}),element.sortable(opts)}}}]),angular.module("ui.directives").directive("uiTinymce",["ui.config",function(uiConfig){return uiConfig.tinymce=uiConfig.tinymce||{},{require:"ngModel",link:function(scope,elm,attrs,ngModel){var expression,options={onchange_callback:function(inst){inst.isDirty()&&(inst.save(),ngModel.$setViewValue(elm.val()),scope.$$phase||scope.$apply())},handle_event_callback:function(){return this.isDirty()&&(this.save(),ngModel.$setViewValue(elm.val()),scope.$$phase||scope.$apply()),!0},setup:function(ed){ed.onSetContent.add(function(ed){ed.isDirty()&&(ed.save(),ngModel.$setViewValue(elm.val()),scope.$$phase||scope.$apply())})}};expression=attrs.uiTinymce?scope.$eval(attrs.uiTinymce):{},angular.extend(options,uiConfig.tinymce,expression),setTimeout(function(){elm.tinymce(options)})}}}]),angular.module("ui.directives").directive("uiValidate",function(){return{restrict:"A",require:"ngModel",link:function(scope,elm,attrs,ctrl){var validateFn,watch,validators={},validateExpr=scope.$eval(attrs.uiValidate);validateExpr&&(angular.isString(validateExpr)&&(validateExpr={validator:validateExpr}),angular.forEach(validateExpr,function(expression,key){validateFn=function(valueToValidate){return scope.$eval(expression,{$value:valueToValidate})?(ctrl.$setValidity(key,!0),valueToValidate):(ctrl.$setValidity(key,!1),void 0)},validators[key]=validateFn,ctrl.$formatters.push(validateFn),ctrl.$parsers.push(validateFn)}),attrs.uiValidateWatch&&(watch=scope.$eval(attrs.uiValidateWatch),angular.isString(watch)?scope.$watch(watch,function(){angular.forEach(validators,function(validatorFn){validatorFn(ctrl.$modelValue)})}):angular.forEach(watch,function(expression,key){scope.$watch(expression,function(){validators[key](ctrl.$modelValue)})})))}}}),angular.module("ui.filters").filter("format",function(){return function(value,replace){if(!value)return value;var token,target=value.toString();return void 0===replace?target:angular.isArray(replace)||angular.isObject(replace)?(token=angular.isArray(replace)&&"$"||":",angular.forEach(replace,function(value,key){target=target.split(token+key).join(value)}),target):target.split("$0").join(replace)}}),angular.module("ui.filters").filter("highlight",function(){return function(text,search,caseSensitive){return search||angular.isNumber(search)?(text=text.toString(),search=search.toString(),caseSensitive?text.split(search).join('<span class="ui-match">'+search+"</span>"):text.replace(new RegExp(search,"gi"),'<span class="ui-match">$&</span>')):text}}),angular.module("ui.filters").filter("inflector",function(){function ucwords(text){return text.replace(/^([a-z])|\s+([a-z])/g,function($1){return $1.toUpperCase()})}function breakup(text,separator){return text.replace(/[A-Z]/g,function(match){return separator+match})}var inflectors={humanize:function(value){return ucwords(breakup(value," ").split("_").join(" "))},underscore:function(value){return value.substr(0,1).toLowerCase()+breakup(value.substr(1),"_").toLowerCase().split(" ").join("_")},variable:function(value){return value=value.substr(0,1).toLowerCase()+ucwords(value.split("_").join(" ")).substr(1).split(" ").join("")}};return function(text,inflector){return inflector!==!1&&angular.isString(text)?(inflector=inflector||"humanize",inflectors[inflector](text)):text}}),angular.module("ui.filters").filter("unique",function(){return function(items,filterOn){if(filterOn===!1)return items;if((filterOn||angular.isUndefined(filterOn))&&angular.isArray(items)){var newItems=[],extractValueToCompare=function(item){return angular.isObject(item)&&angular.isString(filterOn)?item[filterOn]:item};angular.forEach(items,function(item){for(var isDuplicate=!1,i=0;i<newItems.length;i++)if(angular.equals(extractValueToCompare(newItems[i]),extractValueToCompare(item))){isDuplicate=!0;break}isDuplicate||newItems.push(item)}),items=newItems}return items}}),function(){"use strict";var appConfig,servicesConfig;appConfig=["$routeProvider","$locationProvider","$httpProvider","$modalProvider",function($routeProvider,$locationProvider,$httpProvider,$modalProvider){return $httpProvider.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",$locationProvider.html5Mode(!0),$routeProvider.when("/",{templateUrl:"/assets/pages/landing.html"}).when("/admin/authentications",{controller:"RootCtrl"}).when("/landing",{templateUrl:"/assets/pages/landing.html",controller:"RootCtrl"}).when("/proposals",{templateUrl:"/assets/proposals/index.html",controller:"ProposalListCtrl",resolve:{proposals:function(MultiProposalLoader){return MultiProposalLoader()}}}).when("/proposals/:proposalId",{templateUrl:"/assets/proposals/show.html",controller:"ProposalShowCtrl",resolve:{proposal:function(ProposalLoader){return ProposalLoader()},relatedProposals:function(RelatedProposalsLoader){return RelatedProposalsLoader()}}}).when("/currentuser",{resolve:{currentuser:function(CurrentUserLoader){return CurrentUserLoader()}}}).when("/about",{templateUrl:"/assets/pages/about.html"}).when("/terms-of-use",{templateUrl:"/assets/pages/terms-of-use.html"}).when("/privacy",{templateUrl:"/assets/pages/privacy.html"}).otherwise({template:"<h3>Whoops, page not found</h3>"}),$modalProvider.options={backdrop:!0,keyboard:!0,windowClass:""},jQuery(function(){return $("body").prepend('<div id="fb-root"></div>'),$.ajax({url:""+window.location.protocol+"//connect.facebook.net/en_US/all.js",dataType:"script",cache:!0})})}],window.App=angular.module("spokenvote",["ngRoute","spokenvote.services","spokenvote.directives","ui","ui.bootstrap"]).config(appConfig),servicesConfig=["$httpProvider",function($httpProvider){return $httpProvider.responseInterceptors.push("errorHttpInterceptor")}],App.Services=angular.module("spokenvote.services",["ngResource","ngCookies"]).config(servicesConfig).run(function($rootScope,$location){return $rootScope.location=$location}),App.Directives=angular.module("spokenvote.directives",[]),window.getSrv=function(name,element){return element=element||"*[ng-app]",angular.element(element).injector().get(name)},window.getScope=function(element){return angular.element(element).scope()}}.call(this),function(){var DashboardCtrl;DashboardCtrl=["$scope","$route","$location","CurrentHubLoader",function($scope,$route,$location,CurrentHubLoader){return $scope.sessionSettings.routeParams=$route.current.params,$scope.hubFilter={hubFilter:null},null!=$route.current.params.hub&&null==$route.current.params.proposalId&&($scope.hubFilter={hubFilter:!0}),$scope.$on("$locationChangeSuccess",function(){return null==$route.current.params.hub||null!==$scope.hubFilter.hubFilter&&String($scope.hubFilter.hubFilter.select_id)===String($route.current.params.hub)?null==$route.current.params.hub?$scope.hubFilter.hubFilter=null:void 0:CurrentHubLoader().then(function(paramHub){return $scope.sessionSettings.hub_attributes=paramHub,$scope.sessionSettings.hub_attributes.id=$scope.sessionSettings.hub_attributes.select_id,$scope.hubFilter.hubFilter=$scope.sessionSettings.hub_attributes})}),$scope.$watch("hubFilter.hubFilter",function(){return null===$scope.hubFilter.hubFilter?($location.search("hub",null),$scope.sessionSettings.actions.hubFilter="All Groups"):null!=$scope.sessionSettings.hub_attributes.id&&$scope.sessionSettings.actions.selectHub===!0?($scope.sessionSettings.actions.selectHub=!1,$location.path("/proposals").search("hub",$scope.sessionSettings.hub_attributes.id),$scope.sessionSettings.actions.hubFilter=$scope.sessionSettings.hub_attributes.short_hub):void 0}),$scope.hubFilterSelect2={minimumInputLength:1,placeholder:"<div class='fa fa-search'></div><span> Find your Group or Location</span>",width:"100%",allowClear:!0,ajax:{url:"/hubs",dataType:"json",data:function(term){return{hub_filter:term}},results:function(data){return{results:data}}},escapeMarkup:function(m){return m},formatResult:function(searchedHub){return searchedHub.full_hub},formatSelection:function(searchedHub){return _.isEmpty(searchedHub)?void 0:($scope.sessionSettings.hub_attributes=searchedHub,$scope.sessionSettings.actions.changeHub=!1,$scope.sessionSettings.actions.selectHub=!0,$scope.sessionSettings.hub_attributes.id=$scope.sessionSettings.hub_attributes.select_id,$scope.hubFilter.hubFilter=searchedHub,searchedHub.full_hub)},formatNoMatches:function(term){return $scope.sessionSettings.actions.searchTerm=term,'No matches. If you are the first person to use this Group, <a id="navCreateHub" onclick="App.navCreateHub()" href="javascript:" >create it</a>.'},id:function(obj){return obj.select_id},initSelection:function(element,callback){return"new"===$scope.sessionSettings.actions.changeHub?callback({}):CurrentHubLoader().then(function(searchedHub){return _.isEmpty(searchedHub)||($scope.sessionSettings.hub_attributes=searchedHub),callback($scope.sessionSettings.hub_attributes)})}},App.navCreateHub=function(){return $scope.$apply(function(){var currentHub;return $scope.sessionSettings.actions.changeHub="new",currentHub=$scope.sessionSettings.hub_attributes,$scope.sessionSettings.hub_attributes={},$scope.sessionSettings.hub_attributes.location_id=currentHub.location_id,$scope.sessionSettings.hub_attributes.formatted_location=currentHub.formatted_location,$scope.sessionSettings.openModals.newProposal||$scope.sessionSettings.openModals.getStarted||(null!=$scope.currentUser.id?$scope.votingService["new"]($scope):$scope.authService.signinFb($scope).then(function(){return $scope.votingService["new"]($scope)})),angular.element(".select2-dropdown-open").select2("close"),angular.element("#newProposalHub").select2("data",null)})},$scope.clearHubFilter=function(){return $scope.hubFilter.hubFilter=null},$scope.tooltips={navMenu:"Menu",backtoTopics:"Return to Topic list",newTopic:"Start a New Topic"}}],App.controller("DashboardCtrl",DashboardCtrl)}.call(this),function(){var HubsCtrl;HubsCtrl=function($scope,Hub,AlertService){return $scope.hub_attributes={},$scope.hub_attributes.group_name=$scope.searchGroupTerm,$scope.addHub=function(){return AlertService.clearAlerts(),null!=$scope.hub_attributes.formatted_location?Hub.save($scope.hub_attributes,function(response){return AlertService.setSuccess('Your new group "'+response.group_name+'" was created.',$scope),$scope.dismiss()},function(response){return AlertService.setCtlResult("Sorry, your new group was not saved.",$scope),AlertService.setJson(response.data)}):AlertService.setCtlResult("Please select a Location from the provided list.",$scope)},$scope.updateModel=function(){return $scope.hub_attributes.formatted_location=$scope.selectedLocation.formatted_address,$scope.hub_attributes.location_id=$scope.selectedLocation.id}},HubsCtrl.$inject=["$scope","Hub","AlertService"],App.controller("HubsCtrl",HubsCtrl)}.call(this),function(){var ProposalListCtrl,ProposalShowCtrl,RelatedProposalShowCtrl;ProposalListCtrl=["$scope","$routeParams","$location","proposals","SpokenvoteCookies",function($scope,$routeParams,$location,proposals,SpokenvoteCookies){return $scope.proposals=proposals,$scope.spokenvoteSession=SpokenvoteCookies,$scope.sessionSettings.actions.detailPage=!1,$scope.setFilter=function(filterSelected){return $location.search("filter",filterSelected)},$scope.setHub=function(hubSelected){return $location.path("/proposals/").search("hub",hubSelected.id)},$scope.$on("event:proposalsChanged",function(){return $scope.proposals.$query})}],ProposalShowCtrl=["$scope","$location","proposal","relatedProposals",function($scope,$location,proposal,relatedProposals){return $scope.proposal=proposal,$scope.relatedProposals=relatedProposals,$scope.sessionSettings.actions.detailPage=!0,$scope.$on("event:votesChanged",function(){return $scope.proposal.$get()}),$scope.hubView=function(){return $location.path("/proposals").search("hub",proposal.hub.id)},$scope.setVoter=function(vote){return $location.path("/proposals").search("user",vote.user_id),$scope.sessionSettings.actions.userFilter=vote.username},$scope.support=function(clicked_proposal){return null!=$scope.currentUser.id?$scope.votingService.support($scope,clicked_proposal):$scope.authService.signinFb($scope).then(function(){return $scope.votingService.support($scope,clicked_proposal)})},$scope.improve=function(clicked_proposal){return null!=$scope.currentUser.id?$scope.votingService.improve($scope,clicked_proposal):$scope.authService.signinFb($scope).then(function(){return $scope.votingService.improve($scope,clicked_proposal)})},$scope.edit=function(clicked_proposal){return $scope.votingService.edit($scope,clicked_proposal)},$scope["delete"]=function(clicked_proposal){return $scope.votingService["delete"]($scope,clicked_proposal)},$scope.tooltips={support:"<h6><b>Support this proposal</b></h6><b>Supporting:</b> You may support only one proposal on this topic, but are free to change your support to a <i>different</i> proposal at any time by clicking <i>support</i> on that proposal or by composing an <i>improved</i> proposal.",improve:"<h6><b>Create a better proposal</b></h6><b>Improving:</b> By composing an <i>improved</i> proposal you automatically become that proposal's first supporter. You may change your support to a <i>different</i> proposal at any time by supporting it or by composing another <i>improved</i> proposal.",edit:"<h6><b>Edit your proposal</b></h6><b>Editing: </b>You may edit your proposal<br /> up until it receives its first support from<br />another user.","delete":"<h6><b>Delete your proposal</b></h6><b>Deleting: </b>You may delete your<br />proposal up until it receives its first<br />support from another user or if support<br /> ever falls to zero.",twitter:"Share this proposal on Twitter",facebook:"Share this proposal on Facebook",google:"Share this proposal on Google+"},$scope.socialSharing={twitterUrl:$scope.sessionSettings.socialSharing.twitterRootUrl+"Check out this Spokenvote proposal:"+$scope.location.absUrl()+" /via @spokenvote",facebookUrl:$scope.sessionSettings.socialSharing.facebookRootUrl+$scope.location.absUrl(),googleUrl:$scope.sessionSettings.socialSharing.googleRootUrl+$scope.location.absUrl()}}],RelatedProposalShowCtrl=["$scope",function($scope){return $scope.$on("event:votesChanged",function(){return $scope.relatedProposals.$get()}),$scope.related_sorter_dropdown=[{text:"By Votes",submenu:[{text:"Most Votes",click:"sortRelatedProposals('Most Votes')"},{text:"Least Votes",click:"sortRelatedProposals('Least Votes')"}]},{text:"By Age",submenu:[{text:"Most Recently Voted on",click:"sortRelatedProposals('Most Recently Voted on')"},{text:"Oldest Most Recent Vote",click:"sortRelatedProposals('Oldest Most Recent Vote')"}]}],$scope.sortRelatedProposals=function(related_sort_by){return $scope.relatedProposals.$get({id:$scope.proposal.id,related_sort_by:related_sort_by}),$scope.selectedSort=related_sort_by}}],App.controller("ProposalListCtrl",ProposalListCtrl),App.controller("ProposalShowCtrl",ProposalShowCtrl),App.controller("RelatedProposalShowCtrl",RelatedProposalShowCtrl)}.call(this),function(){var RootCtrl;RootCtrl=["$scope","$rootScope","$route","AlertService","$location","$modal","Auth","SessionService","SessionSettings","CurrentUserLoader","VotingService",function($scope,$rootScope,$route,AlertService,$location,$modal,Auth,SessionService,SessionSettings,CurrentUserLoader,VotingService){return $rootScope.alertService=AlertService,$rootScope.authService=Auth,$rootScope.sessionSettings=SessionSettings,$rootScope.votingService=VotingService,CurrentUserLoader().then(function(current_user){return $rootScope.currentUser=current_user,null!=$rootScope.currentUser.username&&"/"===$location.path()?$location.path("/proposals").search("filter","my"):void 0}),window.fbAsyncInit=function(){return FB.init({appId:function(){switch($location.host().substring(0,3)){case"loc":return"449408378433518";case"sta":return"122901591225638";case"www":return"374325849312759"}}(),cookie:!0,status:!0,xfbml:!0})},$scope.$on("event:loginRequired",function(){return $scope.authService.signinFb($scope)}),$scope.signinAuth=function(){return $scope.authService.signinFb($scope)},$scope.userSettings=function(){var modalInstance;return SessionSettings.openModals.userSettings===!1?(modalInstance=$modal.open({templateUrl:"/assets/user/_settings_modal.html",controller:"UserSettingsCtrl",scope:$scope}),modalInstance.opened.then(function(){return SessionSettings.openModals.userSettings=!0}),modalInstance.result["finally"](function(){return SessionSettings.openModals.userSettings=!1})):void 0},$scope.signOut=function(){return SessionService.userOmniauth.$destroy(),$rootScope.currentUser={},$location.path("/").search(""),AlertService.setInfo("You are signed out of Spokenvote.",$scope,"main")},$scope.clearFilter=function(filter){return $location.search(filter,null),$rootScope.sessionSettings.routeParams.user=null},$scope.showProposal=function(proposal){return $location.path("/proposals/"+proposal.id).hash("navigationBar")},$scope.backtoTopics=function(){return $scope.sessionSettings.routeParams=$route.current.params,$location.path("/proposals").hash("prop"+$scope.sessionSettings.routeParams.proposalId)},$scope.newTopic=function(){return null!=$scope.currentUser.id?$scope.votingService["new"]($scope):$scope.authService.signinFb($scope).then(function(){return $scope.votingService["new"]($scope)})},$scope.getStarted=function(){return $scope.votingService.wizard($scope)},$rootScope.rootTips={newHub:"You may change the group to which you are directing this proposal by clicking here."},$scope.googleAuth2=function(){return gapi.auth.authorize(SessionSettings.spokenvote_attributes.googleOauth2Config,function(){return gapi.client.load("oauth2","v2",function(){var request;return request=gapi.client.oauth2.userinfo.get({userId:"me"}),request.execute(function(resp){return SessionService.userOmniauth.auth={provider:"google_oauth2",uid:resp.id,name:resp.name,email:resp.email,avatar_url:resp.picture,token:gapi.auth.getToken()},signInRails()})})})},$scope.signInModal=function(){var d,opts;return SessionSettings.openModals.signIn===!1?(opts={resolve:{$scope:function(){return $scope}}},d=$dialog.dialog(opts),SessionSettings.openModals.signIn=!0,d.open("/assets/shared/_sign_in_modal.html","SessionCtrl").then(function(){return SessionSettings.openModals.signIn=d.isOpen()})):void 0},$scope.registerModal=function(){var d,opts;return SessionSettings.openModals.register===!1?(opts={resolve:{$scope:function(){return $scope}}},d=$dialog.dialog(opts),SessionSettings.openModals.register=!0,d.open("/assets/shared/_registration_modal.html","RegistrationCtrl").then(function(){return SessionSettings.openModals.register=d.isOpen()})):void 0},$scope.omniauthSession=SessionService.userOmniauth,$scope.userOmniauth=function(provider){return $scope.omniauthSession.$save(provider).success(function(response){return response.success===!0&&($scope.dismiss(),AlertService.setSuccess("You  signed in using {{ provider }}!",$scope)),response.success===!1?AlertService.setCtlResult("Sorry, we were not able to sign you in using {{ provider }}.",$scope):void 0})}}],App.controller("RootCtrl",RootCtrl)}.call(this),function(){var RegistrationCtrl,SessionCtrl;SessionCtrl=function($scope,$cookieStore,$location,SessionService,AlertService,dialog){return $scope.session=SessionService.userSession,$scope.signIn=function(){return AlertService.clearAlerts(),SessionService.signedOut?$scope.session.$save().success(function(response){return response.success===!0&&(dialog.close(response),$rootScope.authService.updateUserSession($scope),$location.path("/proposals").search("filter","my"),$scope.session.remember_me===!0&&$cookieStore.put("spokenvote_email",$scope.session.email)),response.success===!1?AlertService.setCtlResult("Sorry, we were not able to sign you in with the supplied email and password.",$scope,"modal"):void 0}):void 0},$scope.close=function(result){return dialog.close(result)}},RegistrationCtrl=function($scope,$cookieStore,$location,SessionService,AlertService,dialog){return $scope.alertService=AlertService,$scope.registration=SessionService.userRegistration,$scope.register=function(){return AlertService.clearAlerts(),SessionService.signedOut?$scope.registration.$save().success(function(response){return response.success===!0&&(dialog.close(response),$location.path("/proposals").search("filter","active"),AlertService.setInfo("Thank you for joining Spokenvote!",$scope,"main"),$rootScope.authService.updateUserSession(scope)),response.success===!1?AlertService.setCtlResult("Sorry, we were not able to save your registration.",$scope,"modal"):void 0}):void 0},$scope.destroy=function(){return $scope.registration.$destroy()},$scope.close=function(result){return dialog.close(result)}},SessionCtrl.$inject=["$scope","$cookieStore","$location","SessionService","AlertService","dialog"],RegistrationCtrl.$inject=["$scope","$cookieStore","$location","SessionService","AlertService","dialog"]}.call(this),function(){var SidebarCtrl;SidebarCtrl=["$scope","$routeParams","$location",function($scope,$routeParams,$location){return $scope.setFilter=function(filterSelected){return $location.path("/proposals").search("filter",filterSelected),$scope.sessionSettings.routeParams.filter=filterSelected},$scope.oneAtATime=!0,$scope.isopen=!1}],App.controller("SidebarCtrl",SidebarCtrl)}.call(this),function(){var UserSettingsCtrl;UserSettingsCtrl=function($scope,$cookieStore,$location,SessionService,AlertService,CurrentUser){return $scope.saveUserSettings=function(){return $scope.newSupport.proposal_id=$scope.clicked_proposal.id,AlertService.clearAlerts(),CurrentUser.save($scope.currentUser,function(response){return AlertService.setSuccess($scope.currentUser.first_name+"'s settings have been updated.",$scope,"main"),dialog.close(response)},function(response){return AlertService.setCtlResult("Sorry, "+$scope.currentUser.first_name+" your settings were not saved.",$scope,"modal"),AlertService.setJson(response.data)})},$scope.close=function(result){return dialog.close(result)}},UserSettingsCtrl.$inject=["$scope","$cookieStore","$location","SessionService","AlertService","CurrentUser"],App.controller("UserSettingsCtrl",UserSettingsCtrl)}.call(this),function(){var DeleteProposalCtrl,EditProposalCtrl,ImroveCtrl,NewProposalCtrl,SupportCtrl;SupportCtrl=["$scope","$location","$rootScope","$modalInstance","Vote",function($scope,$location,$rootScope,$modalInstance,Vote){return $scope.alertService.clearAlerts(),"related_proposal"===$scope.current_user_support&&$scope.alertService.setCtlResult("We found support from you on another proposal. If you continue, your previous support will be moved here.",$scope,"modal"),$scope.saveSupport=function(){var vote;return $scope.newSupport.proposal_id=$scope.clicked_proposal.id,$scope.alertService.clearAlerts(),vote=Vote.save($scope.newSupport,function(response){return $rootScope.$broadcast("event:votesChanged"),$scope.alertService.setSuccess('Your vote was created with the comment: "'+response.comment+'"',$scope,"main"),$modalInstance.close(response)},function(response){return $scope.alertService.setCtlResult("Sorry, your vote to support this proposal was not counted.",$scope,"modal"),$scope.alertService.setJson(response.data)})}}],ImroveCtrl=["$scope","$location","$rootScope","$modalInstance","Proposal",function($scope,$location,$rootScope,$modalInstance,Proposal){return $scope.alertService.clearAlerts(),"related_proposal"===$scope.current_user_support&&$scope.alertService.setCtlResult("We found support from you on another proposal. If you create a new, improved propsal your previous support will be moved here.",$scope,"modal"),$scope.improvedProposal={statement:$scope.clicked_proposal.statement},$scope.saveImprovement=function(){var improvedProposal;return improvedProposal={proposal:{parent_id:$scope.clicked_proposal.id,statement:$scope.improvedProposal.statement,votes_attributes:{comment:$scope.improvedProposal.comment}}},$scope.alertService.clearAlerts(),improvedProposal=Proposal.save(improvedProposal,function(response){return $location.path("/proposals/"+response.id),$scope.alertService.setSuccess('Your improved proposal stating: "'+response.statement+'" was created.',$scope,"main"),$modalInstance.close(response)},function(response){return $scope.alertService.setCtlResult("Sorry, your improved proposal was not saved.",$scope,"modal"),$scope.alertService.setJson(response.data)})}}],EditProposalCtrl=["$scope","$location","$rootScope","$modalInstance","Proposal",function($scope,$location,$rootScope,$modalInstance,Proposal){return $scope.clicked_proposal=$scope.clicked_proposal,$scope.clicked_proposal.votes.length>1&&$scope.alertService.setCtlResult("We found support from other users on your proposal. You can no longer edit your proposal, but you can Improve it to get a similar result.",$scope),$scope.editProposal={id:$scope.clicked_proposal.id,proposal:{statement:$scope.clicked_proposal.statement,votes_attributes:{comment:$scope.clicked_proposal.votes[0].comment,id:$scope.clicked_proposal.votes[0].id}}},$scope.saveEdit=function(){return $scope.alertService.clearAlerts(),Proposal.update($scope.editProposal,function(response){return $rootScope.$broadcast("event:votesChanged"),$scope.alertService.setSuccess('Your proposal stating: "'+response.statement+'" has been saved.',$scope),$modalInstance.close(response)},function(response){return $scope.alertService.setCtlResult("Sorry, your improved proposal was not saved.",$scope),$scope.alertService.setJson(response.data)})}}],DeleteProposalCtrl=["$scope","$location","$rootScope","$modalInstance","Proposal",function($scope,$location,$rootScope,$modalInstance,Proposal){return $scope.clicked_proposal=$scope.clicked_proposal,$scope.clicked_proposal.votes.length>1&&$scope.alertService.setCtlResult("We found support from other users on your proposal. You can no longer delete your proposal, but you can Improve it if you'd like to make a different proposal.",$scope),$scope.deleteProposal=function(){return $scope.alertService.clearAlerts(),Proposal["delete"]($scope.clicked_proposal,function(response){return $scope.alertService.setSuccess('Your proposal stating: "'+$scope.clicked_proposal.statement+'" was deleted.',$scope),$location.path("/proposals").search("hub",$scope.clicked_proposal.hub_id),$modalInstance.close(response)},function(response){return $scope.alertService.setCtlResult("Sorry, your  proposal could not be deleted.",$scope),$scope.alertService.setJson(response.data)})}}],NewProposalCtrl=["$scope","$modalInstance",function($scope,$modalInstance){return $scope.modalInstance=$modalInstance}],App.controller("SupportCtrl",SupportCtrl),App.controller("ImroveCtrl",ImroveCtrl),App.controller("EditProposalCtrl",EditProposalCtrl),App.controller("DeleteProposalCtrl",DeleteProposalCtrl),App.controller("NewProposalCtrl",NewProposalCtrl)}.call(this),function(){var GetStartedCtrl;GetStartedCtrl=["$scope","$location","$modalInstance",function($scope,$location,$modalInstance){return $scope.alertService.clearAlerts(),$scope.modalInstance=$modalInstance,$scope.sessionSettings.hub_attributes.id=null,$scope.sessionSettings.actions.newProposalHub=null,$scope.sessionSettings.actions.changeHub=!0,$scope.sessionSettings.actions.wizardToGroup=null,$scope.goToGroup=function(action){return null!=$scope.sessionSettings.hub_attributes.id?($location.path("/proposals").search("hub",$scope.sessionSettings.hub_attributes.id).hash("navigationBar"),$scope.sessionSettings.actions.hubFilter=$scope.sessionSettings.hub_attributes.group_name,$scope.sessionSettings.actions.wizardToGroup=action):void 0}}],App.controller("GetStartedCtrl",GetStartedCtrl)}.call(this),function(){var alertBar;alertBar=["$parse","$rootScope",function($parse,$rootScope){return{restrict:"A",templateUrl:"/assets/shared/_request_response_partial.html",link:function(scope,elem,attrs){var alertMessageAttr;return alertMessageAttr=attrs.alertmessageclear,$rootScope.hideAlert=function(){return $parse(alertMessageAttr).assign(scope,null)}}}}],App.Directives.directive("alertBar",alertBar)}.call(this),function(){var svGooglePlace;svGooglePlace=function(){return{require:"ngModel",link:function(scope,element,attrs,model){var autocomplete,defaultBounds,options;return model.$parsers.unshift(function(){return model.$setValidity("location",!1)}),defaultBounds=new google.maps.LatLngBounds(new google.maps.LatLng(72.501722,-172.617188),new google.maps.LatLng(14.604847,-61.171875)),options={bounds:defaultBounds,types:["(regions)"]},autocomplete=new google.maps.places.Autocomplete(element[0],options),google.maps.event.addListener(autocomplete,"place_changed",function(){var location;
return location=autocomplete.getPlace(),model.$setValidity("location",!0),scope.$apply(function(){return scope.sessionSettings.hub_attributes.location_id=location.id,scope.sessionSettings.hub_attributes.formatted_location=location.formatted_address})})}}},App.Directives.directive("svGooglePlace",svGooglePlace)}.call(this),function(){App.filter("capitalize",function(){return function(input){return input.substring(0,1).toUpperCase()+input.replace(/_/," ").substring(1)}}),App.filter("slice",function(){return function(arr,start,end){return arr.slice(start,end)}})}.call(this),function(){var CurrentHubLoader,CurrentUser,CurrentUserLoader,Hub,MultiProposalLoader,Proposal,ProposalLoader,RelatedProposals,RelatedProposalsLoader,RelatedVoteInTree,RelatedVoteInTreeLoader,UserOmniauthResource,UserRegistrationResource,UserSessionResource,Vote;CurrentUser=function($resource){return $resource("/currentuser")},Hub=function($resource){return $resource("/hubs/:id",{id:"@id"},{update:{method:"PUT"}})},Vote=function($resource){return $resource("/votes/:id",{id:"@id"},{update:{method:"PUT"}})},Proposal=function($resource){return $resource("/proposals/:id",{id:"@id"},{update:{method:"PUT"}})},RelatedProposals=function($resource){return $resource("/proposals/:id/related_proposals?related_sort_by=:related_sort_by",{id:"@id",related_sort_by:"@related_sort_by"})},RelatedVoteInTree=function($resource){return $resource("/proposals/:id/related_vote_in_tree",{id:"@id"})},UserOmniauthResource=function($http){var UserOmniauth;return UserOmniauth=function(options){return angular.extend(this,options)},UserOmniauth.prototype.$save=function(){return $http.post("/authentications",{auth:this.auth})},UserOmniauth.prototype.$destroy=function(){return $http["delete"]("/users/logout")},UserOmniauth},UserSessionResource=function(){var UserSession;return UserSession=function(options){return angular.extend(this,options)}},UserRegistrationResource=function($http){var UserRegistration;return UserRegistration=function(options){return angular.extend(this,options)},UserRegistration.prototype.$save=function(){return $http.post("/users",{user:{name:this.name,email:this.email,password:this.password,password_confirmation:this.password_confirmation}})},UserRegistration},CurrentUserLoader=function(CurrentUser,$route,$q){return function(){var delay;return delay=$q.defer(),CurrentUser.get({},function(current_user){return delay.resolve(current_user)},function(){return delay.reject("Unable to locate a current user ")}),delay.promise}},CurrentHubLoader=function(Hub,$route,$q){return function(){var delay;return delay=$q.defer(),$route.current.params.hub?Hub.get({id:$route.current.params.hub},function(hub){return delay.resolve(hub)},function(){return delay.reject("Unable to locate a hub ")}):delay.resolve(!1),delay.promise}},ProposalLoader=function(Proposal,$route,$q){return function(){var delay;return delay=$q.defer(),Proposal.get({id:$route.current.params.proposalId},function(proposal){return delay.resolve(proposal)},function(){return delay.reject("Unable to locate proposal "+$route.current.params.proposalId)}),delay.promise}},MultiProposalLoader=["Proposal","$route","$q",function(Proposal,$route,$q){return function(){var delay;return delay=$q.defer(),Proposal.query({hub:$route.current.params.hub,filter:$route.current.params.filter,user:$route.current.params.user},function(proposals){return delay.resolve(proposals)},function(){return delay.reject("Unable to locate proposals for hub"+$route.current.params.hub)}),delay.promise}}],RelatedProposalsLoader=function(RelatedProposals,$route,$q){return function(){var delay;return delay=$q.defer(),RelatedProposals.get({id:$route.current.params.proposalId,related_sort_by:$route.current.params.related_sort_by},function(related_proposals){return delay.resolve(related_proposals)},function(){return delay.reject("Unable to locate related proposals "+$route.current.params.proposalId)}),delay.promise}},RelatedVoteInTreeLoader=function(RelatedVoteInTree,$q){return function(clicked_proposal){var delay;return delay=$q.defer(),RelatedVoteInTree.get({id:clicked_proposal.id},function(relatedVoteInTree){return delay.resolve(relatedVoteInTree)},function(){return delay.reject("Unable to find any related votes in the tree for proposal: "+clicked_proposal.id)}),delay.promise}},CurrentUser.$inject=["$resource"],Hub.$inject=["$resource"],Vote.$inject=["$resource"],Proposal.$inject=["$resource"],RelatedProposals.$inject=["$resource"],RelatedVoteInTree.$inject=["$resource"],UserOmniauthResource.$inject=["$http"],UserSessionResource.$inject=["$http"],UserRegistrationResource.$inject=["$http"],CurrentUserLoader.$inject=["CurrentUser","$route","$q"],CurrentHubLoader.$inject=["Hub","$route","$q"],ProposalLoader.$inject=["Proposal","$route","$q"],RelatedProposalsLoader.$inject=["RelatedProposals","$route","$q"],RelatedVoteInTreeLoader.$inject=["RelatedVoteInTree","$q"],App.Services.factory("CurrentUser",CurrentUser),App.Services.factory("Hub",Hub),App.Services.factory("Vote",Vote),App.Services.factory("Proposal",Proposal),App.Services.factory("CurrentHubLoader",CurrentHubLoader),App.Services.factory("RelatedProposals",RelatedProposals),App.Services.factory("RelatedVoteInTree",RelatedVoteInTree),App.Services.factory("UserOmniauthResource",UserOmniauthResource),App.Services.factory("UserSessionResource",UserSessionResource),App.Services.factory("UserRegistrationResource",UserRegistrationResource),App.Services.factory("CurrentUserLoader",CurrentUserLoader),App.Services.factory("ProposalLoader",ProposalLoader),App.Services.factory("MultiProposalLoader",MultiProposalLoader),App.Services.factory("RelatedProposalsLoader",RelatedProposalsLoader),App.Services.factory("RelatedVoteInTreeLoader",RelatedVoteInTreeLoader)}.call(this),function(){var Auth;Auth=function($q,$rootScope,SessionSettings,SessionService,AlertService,CurrentUserLoader){var fbResolve,signinSv;return fbResolve=function(userInfo,error,deferredFb,scope){return $rootScope.$apply(function(){return AlertService.clearAlerts(),userInfo?(SessionSettings.facebookUser.me=userInfo,signinSv(deferredFb,scope)):(AlertService.setError("Error trying to sign you in to Facebook. Please try again",scope,"main"),null!=error&&(AlertService.setCtlResult(error.message,scope,"main"),console.log(error)),deferredFb.reject(error))})},signinSv=function(deferred,scope){return SessionService.userOmniauth.auth={provider:"facebook",uid:SessionSettings.facebookUser.me.id,name:SessionSettings.facebookUser.me.name,email:null!=SessionSettings.facebookUser.me.email?SessionSettings.facebookUser.me.email:void 0,token:SessionSettings.facebookUser.auth.authResponse.accessToken,expiresIn:SessionSettings.facebookUser.auth.authResponse.expiresIn},SessionService.signedOut?SessionService.userOmniauth.$save().success(function(sessionResponse){return sessionResponse.success===!0&&$rootScope.authService.updateUserSession(scope).then(function(){return deferred.resolve(sessionResponse)}),sessionResponse.success===!1?(AlertService.setCtlResult("Sorry, we were not able to sign you in to Spokenvote.",scope,"main"),deferred.reject(sessionResponse)):void 0}):void 0},{signinFb:function(scope){var deferredFb;return deferredFb=$q.defer(),FB.getLoginStatus(function(authResponse){return"connected"===authResponse.status?(SessionSettings.facebookUser.auth=authResponse,FB.api("/me",function(userInfo){return userInfo.error?fbResolve(null,userInfo.error,deferredFb,scope):fbResolve(userInfo,null,deferredFb,scope)})):FB.login(function(authResponse){return SessionSettings.facebookUser.auth=authResponse,"connected"===authResponse.status?FB.api("/me",function(userInfo){return userInfo.error?fbResolve(null,userInfo.error,deferredFb,scope):fbResolve(userInfo,null,deferredFb,scope)}):fbResolve(null,authResponse,deferredFb,scope)},{scope:"email,user_likes"})}),deferredFb.promise},updateUserSession:function(scope){return CurrentUserLoader().then(function(current_user){return $rootScope.currentUser=current_user,$rootScope.alertService.clearAlerts,$rootScope.alertService.setInfo("You are signed in to Spokenvote!",scope,"main"),$rootScope.$broadcast("event:votesChanged"),CurrentUserLoader()})}}},Auth.$inject=["$q","$rootScope","SessionSettings","SessionService","AlertService","CurrentUserLoader"],App.Services.factory("Auth",Auth)}.call(this),function(){var AlertService,SessionService,SessionSettings,SpokenvoteCookies,errorHttpInterceptor;SessionService=function($cookieStore,UserSessionResource,UserRegistrationResource,UserOmniauthResource){return{currentUser:$cookieStore.get("_spokenvote_session"),signedIn:!!$cookieStore.get("_spokenvote_session"),signedOut:!this.signedIn,userSession:new UserSessionResource({email:$cookieStore.get("spokenvote_email"),password:null,remember_me:!0}),userOmniauth:new UserOmniauthResource({auth:null}),userRegistration:new UserRegistrationResource({name:null,email:$cookieStore.get("spokenvote_email"),password:null,password_confirmation:null})}},AlertService=function($timeout){return{callingScope:null,alertMessage:null,jsonResponse:null,jsonErrors:null,alertClass:null,alertDestination:null,cltActionResult:null,setSuccess:function(msg,scope,dest){return this.alertMessage=msg,this.alertDestination=dest,this.alertClass="alert-success",null!=scope?$timeout(function(){return scope.hideAlert()},7e3):void 0},setInfo:function(msg,scope,dest){return this.alertMessage=msg,this.alertDestination=dest,this.alertClass="alert-info",null!=scope?$timeout(function(){return scope.hideAlert()},7e3):void 0},setError:function(msg,scope,dest){return this.alertMessage=msg,this.alertDestination=dest,this.alertClass="alert-danger",null!=scope?$timeout(function(){return scope.hideAlert()},7e3):void 0},setCtlResult:function(result,scope,dest){return this.cltActionResult=result,this.alertDestination=dest,this.alertClass="alert-danger"},setJson:function(json){return this.jsonResponse=json,json>" "?this.jsonErrors=json:void 0},setCallingScope:function(scope){return this.callingScope=scope},setClass:function(alertclass){return this.alertClass=alertclass},clearAlerts:function(){return this.callingScope=null,this.alertMessage=null,this.jsonResponse=null,this.jsonErrors=null,this.alertClass=null,this.cltActionResult=null}}},errorHttpInterceptor=function($q,$location,$rootScope,AlertService){return function(promise){return promise.then(function(response){return response},function(response){return 406===response.status?(AlertService.setError("Please sign in to continue."),$rootScope.$broadcast("event:loginRequired")):response.status>=400&&response.status<500&&AlertService.setError("The server was unable to process your request."),$q.reject(response)})}},SessionSettings=function(){return{facebookUser:{auth:{},me:{}},actions:{hubFilter:"All Groups",userFilter:null,changeHub:!1,newProposalHub:null,searchTerm:null,wizardToGroup:null,selectHub:!1,offcanvas:!1,detailPage:!1},openModals:{signIn:!1,register:!1,register:!1,userSettings:!1,supportProposal:!1,improveProposal:!1,newProposal:!1,editProposal:!1,deleteProposal:!1,getStarted:!1},searchedHub:{},routeParams:{},hub_attributes:{},newProposal:{},lastLocation:{location_id:null,formatted_location:null},socialSharing:{twitterRootUrl:"http://twitter.com/home?status=",facebookRootUrl:"http://www.facebook.com/sharer.php?u=",googleRootUrl:"https://plus.google.com/share?url="},spokenvote_attributes:{defaultGravatar:"http://www.spokenvote.com/assets/icons/sv-30.png",googleOauth2Config:{client_id:"390524033908-kqnb56kof2vfr4gssi2q84nth2n981g5",scope:["https://www.googleapis.com/auth/plus.login","https://www.googleapis.com/auth/plus.me","https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile"]}}}},SpokenvoteCookies=function($cookies){return $cookies.SpokenvoteSession="Setting a value",{sessionCookie:$cookies.SpokenvoteSession}},SessionService.$inject=["$cookieStore","UserSessionResource","UserRegistrationResource","UserOmniauthResource"],AlertService.$inject=["$timeout"],errorHttpInterceptor.$inject=["$q","$location","$rootScope","AlertService"],SpokenvoteCookies.$inject=["$cookies"],App.Services.factory("SessionService",SessionService),App.Services.factory("AlertService",AlertService),App.Services.factory("errorHttpInterceptor",errorHttpInterceptor),App.Services.factory("SpokenvoteCookies",SpokenvoteCookies),App.Services.factory("SessionSettings",SessionSettings)}.call(this),function(){var VotingService;VotingService=["$rootScope","$location","$modal","AlertService","SessionSettings","RelatedVoteInTreeLoader","Proposal",function($rootScope,$location,$modal,AlertService,SessionSettings,RelatedVoteInTreeLoader,Proposal){return{support:function(scope,clicked_proposal){return scope.clicked_proposal=clicked_proposal,scope.current_user_support=null,AlertService.clearAlerts(),null==scope.currentUser.id?AlertService.setInfo("To support proposals you need to sign in.",scope,"main"):RelatedVoteInTreeLoader(clicked_proposal).then(function(relatedSupport){var modalInstance;return null!=relatedSupport.id&&(scope.current_user_support=relatedSupport.proposal.id===clicked_proposal.id?"this_proposal":"related_proposal"),"this_proposal"===scope.current_user_support?AlertService.setInfo("Good news, it looks as if you have already supported this proposal. Further editing is not allowed at this time.",scope,"main"):SessionSettings.openModals.supportProposal===!1?(modalInstance=$modal.open({templateUrl:"/assets/proposals/_support_modal.html",controller:"SupportCtrl",scope:scope}),modalInstance.opened.then(function(){return SessionSettings.openModals.supportProposal=!0}),modalInstance.result["finally"](function(){return SessionSettings.openModals.supportProposal=!1})):void 0})},improve:function(scope,clicked_proposal){return scope.clicked_proposal=clicked_proposal,scope.current_user_support=null,AlertService.clearAlerts(),null==scope.currentUser.id?AlertService.setInfo("To improve proposals you need to sign in.",scope,"main"):RelatedVoteInTreeLoader(clicked_proposal).then(function(relatedSupport){var modalInstance;return null!=relatedSupport.id&&(scope.current_user_support="related_proposal"),SessionSettings.openModals.improveProposal===!1?(modalInstance=$modal.open({templateUrl:"/assets/proposals/_improve_proposal_modal.html",controller:"ImroveCtrl",scope:scope}),modalInstance.opened.then(function(){return SessionSettings.openModals.improveProposal=!0}),modalInstance.result["finally"](function(){return SessionSettings.openModals.improveProposal=!1})):void 0})},edit:function(scope,clicked_proposal){var modalInstance;return scope.clicked_proposal=clicked_proposal,null==scope.currentUser.id?AlertService.setInfo("To proceed you need to sign in.",scope,"main"):SessionSettings.openModals.editProposal===!1?(modalInstance=$modal.open({templateUrl:"/assets/proposals/_edit_proposal_modal.html",controller:"EditProposalCtrl",scope:scope}),modalInstance.opened.then(function(){return SessionSettings.openModals.editProposal=!0}),modalInstance.result["finally"](function(){return SessionSettings.openModals.editProposal=!1})):void 0},"delete":function(scope,clicked_proposal){var modalInstance;return scope.clicked_proposal=clicked_proposal,null==scope.currentUser.id?AlertService.setInfo("To proceed you need to sign in.",scope,"main"):SessionSettings.openModals.deleteProposal===!1?(modalInstance=$modal.open({templateUrl:"/assets/proposals/_delete_proposal_modal.html",controller:"DeleteProposalCtrl",scope:scope}),modalInstance.opened.then(function(){return SessionSettings.openModals.deleteProposal=!0}),modalInstance.result["finally"](function(){return SessionSettings.openModals.deleteProposal=!1})):void 0},"new":function(){var modalInstance;return AlertService.clearAlerts(),null!=SessionSettings.hub_attributes.id?SessionSettings.actions.changeHub=!1:(SessionSettings.actions.changeHub=!0,SessionSettings.actions.searchTerm=null),null==$rootScope.currentUser.id?AlertService.setInfo("To create proposals you need to sign in.",$rootScope,"main"):SessionSettings.openModals.newProposal===!1?(modalInstance=$modal.open({templateUrl:"/assets/proposals/_new_proposal_modal.html",controller:"NewProposalCtrl"}),modalInstance.opened.then(function(){return SessionSettings.openModals.newProposal=!0}),modalInstance.result["finally"](function(){return SessionSettings.openModals.newProposal=!1})):void 0},wizard:function(){var modalInstance;return SessionSettings.openModals.getStarted===!1?(modalInstance=$modal.open({templateUrl:"/assets/shared/_get_started_modal.html",controller:"GetStartedCtrl"}),modalInstance.opened.then(function(){return SessionSettings.openModals.getStarted=!0}),modalInstance.result["finally"](function(){return SessionSettings.openModals.getStarted=!1})):void 0},changeHub:function(request){return(request=!0&&"new"!==SessionSettings.actions.changeHub)?(SessionSettings.actions.newProposalHub=null,SessionSettings.actions.changeHub=!SessionSettings.actions.changeHub):void 0},saveNewProposal:function($modalInstance){var newProposal;return null==SessionSettings.hub_attributes.id&&(SessionSettings.hub_attributes.group_name=SessionSettings.actions.searchTerm),newProposal={proposal:{statement:SessionSettings.newProposal.statement,votes_attributes:{comment:SessionSettings.newProposal.comment},hub_id:SessionSettings.hub_attributes.id,hub_attributes:SessionSettings.hub_attributes}},AlertService.clearAlerts(),Proposal.save(newProposal,function(response){return $rootScope.$broadcast("event:proposalsChanged"),AlertService.setSuccess('Your new proposal stating: "'+response.statement+'" was created.',$rootScope,"main"),$location.path("/proposals/"+response.id).search("hub",response.hub_id).search("filter","my").hash("navigationBar"),$modalInstance.close(response),SessionSettings.actions.offcanvas=!1},function(response){return AlertService.setCtlResult("Sorry, your new proposal was not saved.",$rootScope,"modal"),AlertService.setJson(response.data)})}}}],App.Services.factory("VotingService",VotingService)}.call(this);